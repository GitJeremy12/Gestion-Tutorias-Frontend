<div class="register-tutoria-container">
  <div class="register-header">
    <h2>Crear SesiÃ³n de TutorÃ­a</h2>
    <p class="subtitle">Crea una sesiÃ³n grupal disponible para estudiantes</p>
  </div>

  <!-- Loading state -->
  <div class="loading-state" *ngIf="cargandoPerfil">
    <div class="spinner"></div>
    <p>Cargando...</p>
  </div>

  <form #f="ngForm" (ngSubmit)="guardar(f)" *ngIf="!cargandoPerfil">

    <!-- Fecha y Hora -->
    <div class="form-section">
      <h3 class="section-title">ğŸ“… Fecha y Hora</h3>

      <div class="form-group">
        <label for="fechaHora">Fecha y hora de la sesiÃ³n *</label>
        <input
          type="datetime-local"
          id="fechaHora"
          [(ngModel)]="form.fechaHora"
          name="fechaHora"
          required
          [min]="getMinDateTime()"
          [max]="getMaxDateTime()"
          (focus)="limpiarMensajes()"
        />
        <small class="hint">Selecciona cuÃ¡ndo se realizarÃ¡ la tutorÃ­a</small>
      </div>
    </div>

    <!-- Detalles AcadÃ©micos -->
    <div class="form-section">
      <h3 class="section-title">ğŸ“š Detalles AcadÃ©micos</h3>

      <div class="form-group">
        <label for="materia">Materia *</label>
        <input
          type="text"
          id="materia"
          [(ngModel)]="form.materia"
          name="materia"
          #materiaField="ngModel"
          placeholder="Ej: CÃ¡lculo Diferencial"
          required
          autocomplete="off"
          (focus)="limpiarMensajes()"
        />
        <small class="error-hint" *ngIf="materiaField.invalid && (materiaField.dirty || materiaField.touched)">
          âš ï¸ La materia es obligatoria
        </small>
      </div>

      <div class="form-group">
        <label for="tema">Tema *</label>
        <input
          type="text"
          id="tema"
          [(ngModel)]="form.tema"
          name="tema"
          #temaField="ngModel"
          placeholder="Ej: Derivadas parciales"
          required
          autocomplete="off"
          (focus)="limpiarMensajes()"
        />
        <small class="error-hint" *ngIf="temaField.invalid && (temaField.dirty || temaField.touched)">
          âš ï¸ El tema es obligatorio
        </small>
      </div>

      <div class="form-group">
        <label for="descripcion">DescripciÃ³n</label>
        <textarea
          id="descripcion"
          [(ngModel)]="form.descripcion"
          name="descripcion"
          rows="4"
          placeholder="Describe quÃ© se verÃ¡ en la sesiÃ³n, material necesario, etc."
          (focus)="limpiarMensajes()"></textarea>
        <small class="hint">Opcional: InformaciÃ³n adicional para los estudiantes</small>
      </div>
    </div>

    <!-- ConfiguraciÃ³n de la SesiÃ³n -->
    <div class="form-section">
      <h3 class="section-title">âš™ï¸ ConfiguraciÃ³n</h3>

      <div class="form-row">
        <div class="form-group">
          <label for="duracion">DuraciÃ³n (minutos) *</label>
          <input
            type="number"
            id="duracion"
            [(ngModel)]="form.duracion"
            name="duracion"
            #duracionField="ngModel"
            min="15"
            max="300"
            step="15"
            required
            (focus)="limpiarMensajes()"
          />
          <small class="hint">Entre 15 y 300 minutos</small>
        </div>

        <div class="form-group">
          <label for="cupoMaximo">Cupo mÃ¡ximo *</label>
          <input
            type="number"
            id="cupoMaximo"
            [(ngModel)]="form.cupoMaximo"
            name="cupoMaximo"
            min="1"
            max="50"
            required
            (focus)="limpiarMensajes()"
          />
          <small class="hint">NÃºmero mÃ¡ximo de estudiantes</small>
        </div>
      </div>

      <div class="form-group">
        <label for="modalidad">Modalidad *</label>
        <select
          [(ngModel)]="form.modalidad"
          id="modalidad"
          name="modalidad"
          required
          (change)="limpiarMensajes()">
          <option value="presencial">ğŸ« Presencial</option>
          <option value="virtual">ğŸ’» Virtual</option>
          <option value="hibrida">ğŸ”„ HÃ­brida</option>
        </select>
      </div>

      <div class="form-group">
        <label for="ubicacion">
          UbicaciÃ³n
          <span class="help-text" *ngIf="form.modalidad === 'presencial'">
            (SalÃ³n o edificio)
          </span>
          <span class="help-text" *ngIf="form.modalidad === 'virtual'">
            (Enlace de videoconferencia)
          </span>
        </label>
        <input
          type="text"
          id="ubicacion"
          [(ngModel)]="form.ubicacion"
          name="ubicacion"
          [placeholder]="form.modalidad === 'virtual'
            ? 'Ej: https://meet.google.com/xxx-yyyy-zzz'
            : 'Ej: Aula 301, Edificio A'"
          (focus)="limpiarMensajes()"
        />
      </div>
    </div>

    <!-- Mensajes -->
    <p class="success" *ngIf="success">
      <span class="success-icon">âœ“</span>
      {{ success }}
    </p>
    <p class="error" *ngIf="error && !success">
      <span class="error-icon">âš ï¸</span>
      {{ error }}
    </p>

    <!-- Botones -->
    <div class="form-actions">
      <button type="button" class="btn-cancel" (click)="cancelar()">
        Cancelar
      </button>
      <button type="submit" class="btn-submit" [disabled]="!f.form.valid || guardando">
        <span *ngIf="!guardando">âœ“ Crear SesiÃ³n</span>
        <span *ngIf="guardando">
          <span class="spinner-small"></span>
          Creando...
        </span>
      </button>
    </div>
  </form>
</div>
